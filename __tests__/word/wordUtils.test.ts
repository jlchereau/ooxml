import { sanitizeWordMarkup } from '../../src/word/wordUtils';
import constants from '../../src/constants';
import {hasTagsRegExp} from "../../src/tags/tagUtils";

const XML = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><w:document xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:cx="http://schemas.microsoft.com/office/drawing/2014/chartex" xmlns:cx1="http://schemas.microsoft.com/office/drawing/2015/9/8/chartex" xmlns:cx2="http://schemas.microsoft.com/office/drawing/2015/10/21/chartex" xmlns:cx3="http://schemas.microsoft.com/office/drawing/2016/5/9/chartex" xmlns:cx4="http://schemas.microsoft.com/office/drawing/2016/5/10/chartex" xmlns:cx5="http://schemas.microsoft.com/office/drawing/2016/5/11/chartex" xmlns:cx6="http://schemas.microsoft.com/office/drawing/2016/5/12/chartex" xmlns:cx7="http://schemas.microsoft.com/office/drawing/2016/5/13/chartex" xmlns:cx8="http://schemas.microsoft.com/office/drawing/2016/5/14/chartex" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:aink="http://schemas.microsoft.com/office/drawing/2016/ink" xmlns:am3d="http://schemas.microsoft.com/office/drawing/2017/model3d" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:oel="http://schemas.microsoft.com/office/2019/extlst" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing" xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" xmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml" xmlns:w15="http://schemas.microsoft.com/office/word/2012/wordml" xmlns:w16cex="http://schemas.microsoft.com/office/word/2018/wordml/cex" xmlns:w16cid="http://schemas.microsoft.com/office/word/2016/wordml/cid" xmlns:w16="http://schemas.microsoft.com/office/word/2018/wordml" xmlns:w16sdtdh="http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash" xmlns:w16se="http://schemas.microsoft.com/office/word/2015/wordml/symex" xmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup" xmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape" mc:Ignorable="w14 w15 w16se w16cid w16 w16cex w16sdtdh wp14"><w:body><w:p w14:paraId="6D72E4D0" w14:textId="20622C1E" w:rsidR="00976CA6" w:rsidRDefault="00517902"><w:r><w:t>Text: {{text}}</w:t></w:r></w:p><w:p w14:paraId="1321D953" w14:textId="29EAB936" w:rsidR="00517902" w:rsidRDefault="00D45415"><w:r><w:t>Integer: {{</w:t></w:r><w:r w:rsidR="00BD72CA"><w:t>integer</w:t></w:r><w:r><w:t>}}</w:t></w:r></w:p><w:p w14:paraId="5300F5BF" w14:textId="12F863AB" w:rsidR="00D45415" w:rsidRDefault="003310A0"><w:r><w:t>Float: {{float}}</w:t></w:r></w:p><w:p w14:paraId="019701C2" w14:textId="46BA9645" w:rsidR="00F95B5E" w:rsidRDefault="00F95B5E"><w:r><w:t>Date: {{date}}</w:t></w:r></w:p><w:p w14:paraId="344D692E" w14:textId="333E965B" w:rsidR="003310A0" w:rsidRDefault="003310A0"><w:r><w:t>Boolean: {{boolean}}</w:t></w:r></w:p><w:p w14:paraId="3CB09FE2" w14:textId="77777777" w:rsidR="003310A0" w:rsidRDefault="003310A0" w:rsidP="003310A0"><w:pPr><w:pBdr><w:bottom w:val="single" w:sz="4" w:space="1" w:color="auto"/></w:pBdr></w:pPr></w:p><w:p w14:paraId="67FE3EB7" w14:textId="2128830F" w:rsidR="0040418C" w:rsidRDefault="00D050CC" w:rsidP="00D050CC"><w:pPr><w:pStyle w:val="Heading1"/></w:pPr><w:r><w:t>Heading: {{text}}</w:t></w:r></w:p><w:p w14:paraId="5769B5C8" w14:textId="4CA22C9F" w:rsidR="00D050CC" w:rsidRDefault="00D050CC" w:rsidP="0040418C"><w:r><w:t>Bold Italic</w:t></w:r><w:r w:rsidR="00612FFA"><w:t xml:space="preserve"> red and highlighted</w:t></w:r><w:r><w:t xml:space="preserve">: </w:t></w:r><w:r w:rsidRPr="00D050CC"><w:rPr><w:b/><w:bCs/><w:i/><w:iCs/><w:color w:val="FF0000"/><w:highlight w:val="yellow"/></w:rPr><w:t>{{text}}</w:t></w:r></w:p><w:p w14:paraId="49DCD1AE" w14:textId="784AC897" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr></w:pPr><w:r><w:t>Text: {{text}}</w:t></w:r></w:p><w:p w14:paraId="3764DA47" w14:textId="47CF2A77" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr></w:pPr><w:r><w:t>Integer: {{</w:t></w:r><w:r w:rsidR="00BD72CA"><w:t>integer</w:t></w:r><w:r><w:t>}}</w:t></w:r></w:p><w:p w14:paraId="33169602" w14:textId="77777777" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr></w:pPr><w:r><w:t>Float: {{float}}</w:t></w:r></w:p><w:p w14:paraId="328015C6" w14:textId="77777777" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr></w:pPr><w:r><w:t>Date: {{date}}</w:t></w:r></w:p><w:p w14:paraId="35F08C45" w14:textId="215D2F04" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:pStyle w:val="ListParagraph"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="2"/></w:numPr></w:pPr><w:r><w:t>Boolean: {{boolean}}</w:t></w:r></w:p><w:p w14:paraId="1464664C" w14:textId="77777777" w:rsidR="00612FFA" w:rsidRDefault="00612FFA" w:rsidP="00612FFA"><w:pPr><w:pBdr><w:bottom w:val="single" w:sz="4" w:space="1" w:color="auto"/></w:pBdr></w:pPr></w:p><w:tbl><w:tblPr><w:tblStyle w:val="GridTable4-Accent1"/><w:tblW w:w="0" w:type="auto"/><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="1803"/><w:gridCol w:w="1803"/><w:gridCol w:w="1803"/><w:gridCol w:w="1803"/><w:gridCol w:w="1804"/></w:tblGrid><w:tr w:rsidR="00D651AB" w14:paraId="54F5944A" w14:textId="77777777" w:rsidTr="006F7B6B"><w:trPr><w:cnfStyle w:val="100000000000" w:firstRow="1" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:trPr><w:tc><w:tcPr><w:cnfStyle w:val="001000000000" w:firstRow="0" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="6C865035" w14:textId="1BD7F002" w:rsidR="00D651AB" w:rsidRDefault="00D651AB" w:rsidP="00612FFA"><w:r><w:t>Text</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="77BFFF94" w14:textId="6085CDA4" w:rsidR="00D651AB" w:rsidRDefault="00D651AB" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="100000000000" w:firstRow="1" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>Integer</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="1BBCDA90" w14:textId="24C1BE5A" w:rsidR="00D651AB" w:rsidRDefault="00D651AB" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="100000000000" w:firstRow="1" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>Float</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="37197B4A" w14:textId="721C54AC" w:rsidR="00D651AB" w:rsidRDefault="00D651AB" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="100000000000" w:firstRow="1" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>Date</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1804" w:type="dxa"/></w:tcPr><w:p w14:paraId="679B8977" w14:textId="3A4DC311" w:rsidR="00D651AB" w:rsidRDefault="00D651AB" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="100000000000" w:firstRow="1" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>Boolean</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00FE5045" w14:paraId="415A8F4F" w14:textId="77777777" w:rsidTr="006F7B6B"><w:trPr><w:cnfStyle w:val="000000100000" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="1" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:trPr><w:tc><w:tcPr><w:cnfStyle w:val="001000000000" w:firstRow="0" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="0" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="0174D7F0" w14:textId="43063293" w:rsidR="00FE5045" w:rsidRDefault="00FE5045" w:rsidP="00612FFA"><w:r><w:t>{{text}}</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="7A8CD026" w14:textId="157B842D" w:rsidR="00FE5045" w:rsidRDefault="00FE5045" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="000000100000" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="1" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>{{</w:t></w:r><w:r w:rsidR="00BD72CA"><w:t>integer</w:t></w:r><w:r><w:t>}}</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="071A4A54" w14:textId="41D2F448" w:rsidR="00FE5045" w:rsidRDefault="00FE5045" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="000000100000" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="1" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>{{float}}</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1803" w:type="dxa"/></w:tcPr><w:p w14:paraId="16A23596" w14:textId="373CFDB0" w:rsidR="00FE5045" w:rsidRDefault="00FE5045" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="000000100000" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="1" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>{{date}}</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="1804" w:type="dxa"/></w:tcPr><w:p w14:paraId="67EE7064" w14:textId="6292F1BB" w:rsidR="00FE5045" w:rsidRDefault="00FE5045" w:rsidP="00612FFA"><w:pPr><w:cnfStyle w:val="000000100000" w:firstRow="0" w:lastRow="0" w:firstColumn="0" w:lastColumn="0" w:oddVBand="0" w:evenVBand="0" w:oddHBand="1" w:evenHBand="0" w:firstRowFirstColumn="0" w:firstRowLastColumn="0" w:lastRowFirstColumn="0" w:lastRowLastColumn="0"/></w:pPr><w:r><w:t>{{</w:t></w:r><w:r w:rsidR="00BD72CA"><w:t>b</w:t></w:r><w:r><w:t>oolean}}</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1E03D739" w14:textId="77777777" w:rsidR="00612FFA" w:rsidRDefault="00612FFA" w:rsidP="00612FFA"/><w:p w14:paraId="29BA738A" w14:textId="77777777" w:rsidR="00612FFA" w:rsidRDefault="00612FFA" w:rsidP="00612FFA"/><w:p w14:paraId="492C8F7F" w14:textId="77777777" w:rsidR="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:jc w:val="center"/></w:pPr></w:p><w:p w14:paraId="3B6EAFFC" w14:textId="77777777" w:rsidR="0040418C" w:rsidRPr="0040418C" w:rsidRDefault="0040418C" w:rsidP="0040418C"><w:pPr><w:jc w:val="center"/></w:pPr></w:p><w:sectPr w:rsidR="0040418C" w:rsidRPr="0040418C"><w:headerReference w:type="default" r:id="rId7"/><w:footerReference w:type="default" r:id="rId8"/><w:pgSz w:w="11906" w:h="16838"/><w:pgMar w:top="1440" w:right="1440" w:bottom="1440" w:left="1440" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr></w:body></w:document>'

test('sanitizeWordMarkup', () => {
    const count = (XML.match(hasTagsRegExp(constants.delimiters)) || []).length;
    const xml = sanitizeWordMarkup(XML, constants.delimiters);
    expect((XML.match(hasTagsRegExp()) || []).length).toEqual(count);
    expect((XML.match(/{{<[^{}]+}}/g) || []).length).toBeGreaterThan(0);
    expect((xml.match(/{{<[^{}]+}}/g) || []).length).toEqual(0);
});